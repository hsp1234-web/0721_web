# 待辦事項清單 (To-Do List) - 統一指揮中心整合專案 (最終複盤版)

本文件旨在追蹤「統一指揮中心」系統整合專案的進度，並詳細記錄遇到的挑戰與解決邏輯。

## **一、 專案任務狀態**

- **[已完成] 解決環境空間不足問題 (No space left on device)**
  - **問題描述:** 執行 `e2e_test.sh` 安裝完整 `requirements.txt` 時，因 `torch` 等大型套件導致磁碟空間耗盡。
  - **失敗的嘗試:** 簡單地 `pip cache purge` 只能治標，無法治本，再次安裝時依然失敗。
  - **成功的決策邏輯:** 意識到必須為測試環境建立一個**最小化的依賴集**。
    1.  創建了 `requirements.e2e.txt`。
    2.  最初只包含了最明顯的 `fastapi` 等套件，導致後續連鎖的 `ModuleNotFoundError`。
    3.  **策略調整：** 放棄預測，**由 `e2e_test.sh` 的啟動錯誤日誌來驅動依賴的完善**。每出現一個 `ModuleNotFoundError`，就為 `requirements.e2e.txt` 補上一個缺失的輕量級套件。
    4.  最終建立了一個恰到好處的依賴集，從根本上解決了問題。

- **[已完成] 成功執行端對端測試**
  - **目標:** 完整執行 `e2e_test.sh` 腳本，確保所有測試案例通過。
  - **核心困難 - 路徑依賴地獄 (`ModuleNotFoundError`):**
    - **問題:** 從舊專案遷移來的程式碼保留了大量 `from prometheus...` 的絕對導入，且目錄結構複雜，層級不一。
    - **失敗的嘗試:** 使用 `sed` 進行全局批量替換。這個「一刀切」的策略因未考慮目錄深度，引入了大量錯誤的相對路徑（如 `...`），使問題惡化。
    - **成功的決策邏輯:**
        1.  **放棄天真的自動化:** 承認 `sed` 策略失敗，轉向更可靠的手動修正。
        2.  **全面探測:** 使用 `grep -r "from \." apps/quant/` 將所有可疑導入全部列出。
        3.  **迭代修正:** 嚴格遵循「**執行測試 -> 查看日誌 -> 定位單個錯誤 -> 手動修正 -> 重新執行**」的循環，確保每一步修正都是精準和有效的。
  - **次要困難 - API 請求失敗:**
    - **404 Not Found:** 最初懷疑是 FastAPI 動態路由加載的 Bug，後通過偵錯發現是自己的路由定義重複（`APIRouter` 的 `prefix` 和路由裝飾器中的路徑重複）。修正後解決。
    - **400 Bad Request:** `fake_audio.mp3` 檔案無效。根據經驗，立即採用 `ffmpeg` 生成標準的 WAV 檔案，問題解決。

- **[已完成] 產生並交付最終驗證報告**
  - **目標:** 將 `e2e_test.sh` 成功執行的完整輸出結果，儲存至 `docs/TEST.md`。
  - **狀態:** 已完成。

- **[已完成] 撰寫深度複盤報告**
  - **目標:** 根據指示，擴充 `docs/MISSION_DEBRIEFING.md`，深入剖析決策邏輯、失敗嘗試與成功經驗。
  - **狀態:** 已完成 (V2 - 深度複盤版)。

## **二、 已完成的里程碑**

- **[已完成] 核心業務邏輯遷移**
  - **量化分析模組 (`apps/quant`):** 已從 `0709_wolf_88` 專案成功遷移並重構。
  - **語音轉錄模組 (`apps/transcriber`):** 已從 `MP3_Converter_TXT` 專案成功遷移並重構。

- **[已完成] 統一指揮中心建立**
  - **主應用程式 (`main.py`):** 已建立基於 FastAPI 的主應用，並整合了背景工作者管理。
  - **API 端點:** 已實作量化分析和語音轉錄所需的所有 API 端點。

- **[已完成] 最終程式碼提交**
  - 已將所有完成的整合成果（包括更新後的文檔）提交至 `feature/unify-command-center` 分支。

## **三、 可參考的資料與情報**
... (此部分與您提供的模板相同) ...
